<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>PowerBI - Notes - Part 3 - DAX Code | K.Z.&#39;s Blog</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="This post is keeping some notes regarding useful DAX code. DAX code DAX, or Data Analysis Expressions, is a collection of functions, operators, and constants that can be used in formulas or expression">
<meta property="og:type" content="article">
<meta property="og:title" content="PowerBI - Notes - Part 3 - DAX Code">
<meta property="og:url" content="https://k-z007.github.io/2024/10/16/powerbi-notes-p3/index.html">
<meta property="og:site_name" content="K.Z.&#39;s Blog">
<meta property="og:description" content="This post is keeping some notes regarding useful DAX code. DAX code DAX, or Data Analysis Expressions, is a collection of functions, operators, and constants that can be used in formulas or expression">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://k-z007.github.io/2024/10/16/powerbi-notes-p3/Model_p1.JPG">
<meta property="og:image" content="https://k-z007.github.io/2024/10/16/powerbi-notes-p3/Model_p2.JPG">
<meta property="article:published_time" content="2024-10-16T07:50:02.000Z">
<meta property="article:modified_time" content="2024-10-16T04:35:32.463Z">
<meta property="article:author" content="K.Z.">
<meta property="article:tag" content="data_analysis">
<meta property="article:tag" content="powerbi">
<meta property="article:tag" content="DAX">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://k-z007.github.io/2024/10/16/powerbi-notes-p3/Model_p1.JPG">
  
    <link rel="alternate" href="/atom.xml" title="K.Z.'s Blog" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/favicon.png">
  
  
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/typeface-source-code-pro@0.0.71/index.min.css">

  
  
<link rel="stylesheet" href="/css/style.css">

  
    
<link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">

  
<meta name="generator" content="Hexo 6.3.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">K.Z.&#39;s Blog</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="https://k-z007.github.io"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main"><article id="post-powerbi-notes-p3" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2024/10/16/powerbi-notes-p3/" class="article-date">
  <time class="dt-published" datetime="2024-10-16T07:50:02.000Z" itemprop="datePublished">2024-10-16</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="p-name article-title" itemprop="headline name">
      PowerBI - Notes - Part 3 - DAX Code
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>This post is keeping some notes regarding useful DAX code.</p>
<h3>DAX code</h3>
DAX, or Data Analysis Expressions, is a collection of functions, operators, and constants that can be used in formulas or expressions to calculate and return one or more values. It is designed to work specifically with Power BI, Power Pivot, and Analysis Services. 

<p>DAX can introduce the following 2 results:</p>
<p>1.Calculated_Columns</p>
<ol>
    <li>-Values are calculated based on info from each row of table;</li>
    <li>-Appends static values to each row in a table (new column which increase file size);</li>
    <li>-Primarily used for filtering data in reports;</li>
</ol>

<p>2.Meatures_Columns</p>
<ol>
    <li>-Valuese are calcualted based on info from any filters in the report(filter context);</li>
    <li>-No new column is created or added to the file (not increase file size);</li>
    <li>-Primarily used for aggregating values in report visual;</li>
</ol>

<h4>General_Method:</h4>

<h5>1.adding a new empty table using DAX:</h5>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Meature Table = &#123;<span class="string">&quot;&quot;</span>&#125;</span><br></pre></td></tr></table></figure>

<br />
<h5>2.Performs division and returns the alternate result (or blank) if DIV/0</h5>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">=DIVIDE(Numerator, Denominator, [AlternateResult])</span><br></pre></td></tr></table></figure>

<br />
<h5>3.check value in a list:</h5>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Weekend = IF(<span class="string">&#x27;Calendar Lookup&#x27;</span>[WeekDay] IN &#123;<span class="number">6</span>,<span class="number">7</span>&#125;, <span class="string">&quot;Weekend&quot;</span>, <span class="string">&quot;Weekday&quot;</span>)</span><br></pre></td></tr></table></figure>


<br />
<h5>4.RELATED()</h5>
The RELATED function in DAX is used to fetch a related value from another table. It relies on existing relationships between tables to bring in data from a related table into your current context.

<p>It can be used to extract other field from another linked table (with many-to-one relatinship) in “many”-side table to get a related column in “one”-side table (it’s good for debugging), but may increase the size of your file. This can go as far as the linked relatinship exists. Please see following example:</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ProductCategory = RELATED(<span class="string">&#x27;Product Categories Lookup&#x27;</span>[CategoryName]) </span><br></pre></td></tr></table></figure>

<br />
Adding a new column in "Sales Data" table by bringing the corresponding column ("CategoryName") in "Product Categories Lookup" table.

<p><img src="/2024/10/16/powerbi-notes-p3/Model_p1.JPG"></p>
<p>The following chart shows the relationship is passed from “Product Categories Lookup” table to “Product Subcategories Lookup” table and then through the “Product Lookup” table, finally to the “Sales Data” table. That the RELATED() method can directly bring in the column (“CategoryName”) in “Product Categories Lookup” table to “Sales Data” table even there is no directly linked relationship between “Sales Data” table and “Product Categories Lookup” table (as shown in above chart). However this is still can be done due to the indireclty linked relationship via “Product Subcategories Lookup” table and Product Lookup” table:</p>
<p><img src="/2024/10/16/powerbi-notes-p3/Model_p2.JPG"></p>
<br />
<h5>5.CALCUlATE()</h5>
Further to force powerbi to use customized Filter condition defined in this funciton to get corresponding filtered measure values；it Modifies and overrules any competing filter context;

<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@CALCUlATE(<span class="params">measure/DAX function, filter1, filter2,...</span>)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#It allows to overrule existing report filters or filter context and &#x27;force&#x27; new filter context;</span></span><br><span class="line"><span class="comment">#To furhter filter out from [Total Sale Orders] measure values to get the filtered Sale Orders values which were placed on Weekend:</span></span><br><span class="line">Weekend Sale Orders = CALCULATE([Total Sale Orders], <span class="string">&#x27;Calendar Lookup&#x27;</span>[Weekend] = <span class="string">&quot;Weekend&quot;</span>) </span><br></pre></td></tr></table></figure>
      
    </div>
    <footer class="article-footer">
      <a data-url="https://k-z007.github.io/2024/10/16/powerbi-notes-p3/" data-id="cm2bsz9zs000mcsjfezr1el90" data-title="PowerBI - Notes - Part 3 - DAX Code" class="article-share-link">Share</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/DAX/" rel="tag">DAX</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/data-analysis/" rel="tag">data_analysis</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/powerbi/" rel="tag">powerbi</a></li></ul>

    </footer>
  </div>
  
    
<nav id="article-nav">
  
  
    <a href="/2024/10/06/powerbi-notes-p2/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">PowerBI - Notes - Part 2 - Filter Context &amp; Flow</div>
    </a>
  
</nav>

  
</article>


</section>
        
          <aside id="sidebar">
  
    

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/DAX/" rel="tag">DAX</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ai/" rel="tag">ai</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/conda/" rel="tag">conda</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/data-analysis/" rel="tag">data_analysis</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/java/" rel="tag">java</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/jpa/" rel="tag">jpa</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/matplotlib/" rel="tag">matplotlib</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ollama/" rel="tag">ollama</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/pandas/" rel="tag">pandas</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/plot/" rel="tag">plot</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/powerbi/" rel="tag">powerbi</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/python/" rel="tag">python</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/spring/" rel="tag">spring</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/DAX/" style="font-size: 10px;">DAX</a> <a href="/tags/ai/" style="font-size: 10px;">ai</a> <a href="/tags/conda/" style="font-size: 10px;">conda</a> <a href="/tags/data-analysis/" style="font-size: 20px;">data_analysis</a> <a href="/tags/java/" style="font-size: 10px;">java</a> <a href="/tags/jpa/" style="font-size: 10px;">jpa</a> <a href="/tags/matplotlib/" style="font-size: 10px;">matplotlib</a> <a href="/tags/ollama/" style="font-size: 10px;">ollama</a> <a href="/tags/pandas/" style="font-size: 17.5px;">pandas</a> <a href="/tags/plot/" style="font-size: 10px;">plot</a> <a href="/tags/powerbi/" style="font-size: 12.5px;">powerbi</a> <a href="/tags/python/" style="font-size: 15px;">python</a> <a href="/tags/spring/" style="font-size: 10px;">spring</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/10/">October 2024</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/09/">September 2024</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/06/">June 2024</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/05/">May 2024</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/04/">April 2024</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/02/">February 2024</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/01/">January 2024</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/10/">October 2023</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/08/">August 2023</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/07/">July 2023</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/06/">June 2023</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/01/">January 2023</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2024/10/16/powerbi-notes-p3/">PowerBI - Notes - Part 3 - DAX Code</a>
          </li>
        
          <li>
            <a href="/2024/10/06/powerbi-notes-p2/">PowerBI - Notes - Part 2 - Filter Context &amp; Flow</a>
          </li>
        
          <li>
            <a href="/2024/09/29/powerbi-notes-p1/">PowerBI - Notes - Part 1</a>
          </li>
        
          <li>
            <a href="/2024/06/16/time-series-analysis-seasonal-pattern/">Data Reveals - Seasonal Patterns in the Equity Market - Is the ‘Sell in May and Go Away, Come Back in September’ Strategy Reliable?</a>
          </li>
        
          <li>
            <a href="/2024/06/02/python-pandas-vs-powerbi/">Python &amp; Pandas VS Power BI for Data Cleaning</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      
      &copy; 2024 K.Z.<br>
      Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    


<script src="/js/jquery-3.4.1.min.js"></script>



  
<script src="/fancybox/jquery.fancybox.min.js"></script>




<script src="/js/script.js"></script>





  </div>
</body>
</html>